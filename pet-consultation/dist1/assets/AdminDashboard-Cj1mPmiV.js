import{r as d,g as R,j as e,m as O,l as _,u as X,h as U}from"./index-BgTIe4Qm.js";import{B}from"./Button-CFZU5Yrt.js";import{I as Z}from"./InputField-y3Sg7NNn.js";import{L as ee}from"./LoadingSpinner-Bc9-TOfe.js";const se=({user:l,isOpen:b,onClose:y})=>{const[i,f]=d.useState(null),[x,L]=d.useState(!1),[S,k]=d.useState(""),[N,m]=d.useState("overview"),[I,n]=d.useState(!1);d.useEffect(()=>{b&&l&&o()},[b,l]);const o=async()=>{L(!0),k("");try{const t=await R.getUserSubmissions(l.id);f(t.data||t)}catch(t){console.error("Error fetching user submissions:",t),f({user:l,totalSubmissions:2,totalMediaFiles:5,pets:l.pets||[{id:1,name:"میو",petType:"گربه",breed:"پرشین",age:3,gender:"نر",weight:4.5}],payments:[{id:1,amount:28e4,status:"VERIFIED",createdAt:new Date().toISOString(),description:"پرداخت مشاوره"}],consultations:[{id:1,consultationType:"مشاوره عمومی",status:"COMPLETED",description:"مشاوره در مورد تغذیه حیوان خانگی",createdAt:new Date().toISOString(),pet:{name:"میو",petType:"گربه",breed:"پرشین"},medicalDocuments:["document1.pdf","xray1.jpg"],videos:["video1.mp4"],audioFiles:["voice1.mp3"],mediaCount:4}]}),k("")}finally{L(!1)}},u=async(t="json")=>{n(!0);try{const c=await R.downloadUserRecord(l.id),E=new Blob([c.data||c],{type:"application/zip"}),A=window.URL.createObjectURL(E),D=document.createElement("a");D.href=A,D.download=`user_${l.mobile}_records.zip`,document.body.appendChild(D),D.click(),document.body.removeChild(D),window.URL.revokeObjectURL(A)}catch(c){k(c.message||"خطا در دانلود فایل")}finally{n(!1)}},C=t=>new Date(t).toLocaleDateString("fa-IR"),h=t=>new Intl.NumberFormat("fa-IR").format(t)+" تومان",M=t=>{const c=t.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif","webp"].includes(c)?"🖼️":["mp4","avi","mov","wmv"].includes(c)?"🎥":["mp3","wav","ogg","m4a"].includes(c)?"🎵":["pdf"].includes(c)?"📄":"📎"},p=t=>{const c=R.getMediaUrl(t);window.open(c,"_blank")};return b?e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-10 mx-auto p-5 border w-11/12 md:w-5/6 lg:w-4/5 xl:w-3/4 shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"اطلاعات جامع کاربر"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l.fullName," - ",l.mobile]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{onClick:()=>u("json"),disabled:I,variant:"outline",size:"sm",children:I?"در حال دانلود...":"دانلود JSON"}),e.jsx(B,{onClick:()=>u("csv"),disabled:I,variant:"outline",size:"sm",children:"دانلود CSV"}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),x&&e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"mr-3 text-gray-600",children:"در حال بارگذاری..."})]}),S&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:S}),i&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.totalSubmissions}),e.jsx("div",{className:"text-sm text-blue-800",children:"کل مشاوره‌ها"})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.totalMediaFiles}),e.jsx("div",{className:"text-sm text-green-800",children:"فایل‌های رسانه‌ای"})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.pets.length}),e.jsx("div",{className:"text-sm text-purple-800",children:"حیوانات خانگی"})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.payments.length}),e.jsx("div",{className:"text-sm text-yellow-800",children:"پرداخت‌ها"})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>m("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${N==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"خلاصه اطلاعات"}),e.jsx("button",{onClick:()=>m("consultations"),className:`py-2 px-1 border-b-2 font-medium text-sm ${N==="consultations"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"مشاوره‌ها و رسانه‌ها"}),e.jsx("button",{onClick:()=>m("pets"),className:`py-2 px-1 border-b-2 font-medium text-sm ${N==="pets"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"حیوانات خانگی"}),e.jsx("button",{onClick:()=>m("payments"),className:`py-2 px-1 border-b-2 font-medium text-sm ${N==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"پرداخت‌ها"})]})}),N==="overview"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"اطلاعات کاربر"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"نام کامل:"})," ",i.user.fullName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"شماره موبایل:"})," ",i.user.mobile]}),e.jsxs("p",{children:[e.jsx("strong",{children:"تاریخ عضویت:"})," ",C(i.user.createdAt)]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"آمار فعالیت"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"تعداد مشاوره‌ها:"})," ",i.totalSubmissions]}),e.jsxs("p",{children:[e.jsx("strong",{children:"فایل‌های رسانه‌ای:"})," ",i.totalMediaFiles]}),e.jsxs("p",{children:[e.jsx("strong",{children:"حیوانات ثبت شده:"})," ",i.pets.length]})]})]})]})}),N==="consultations"&&e.jsx("div",{className:"space-y-4",children:i.consultations.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["مشاوره #",t.id]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.consultationType})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.status==="COMPLETED"?"bg-green-100 text-green-800":t.status==="IN_PROGRESS"?"bg-blue-100 text-blue-800":t.status==="PENDING_PAYMENT"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.status==="COMPLETED"?"تکمیل شده":t.status==="IN_PROGRESS"?"در حال انجام":t.status==="PENDING_PAYMENT"?"در انتظار پرداخت":t.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C(t.createdAt)})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("p",{className:"text-sm text-gray-700",children:t.description})}),t.pet&&e.jsxs("div",{className:"bg-blue-50 p-3 rounded mb-3",children:[e.jsx("h5",{className:"font-medium text-blue-900 mb-1",children:"حیوان مربوطه"}),e.jsxs("p",{className:"text-sm text-blue-800",children:[t.pet.name," - ",t.pet.petType," (",t.pet.breed,")"]})]}),(t.medicalDocuments.length>0||t.videos.length>0||t.audioFiles.length>0)&&e.jsxs("div",{className:"border-t pt-3",children:[e.jsxs("h5",{className:"font-medium text-gray-900 mb-2",children:["فایل‌های رسانه‌ای (",t.mediaCount,")"]}),t.medicalDocuments.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-1",children:"مدارک پزشکی"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:t.medicalDocuments.map((c,E)=>e.jsxs("button",{onClick:()=>p(c),className:"flex items-center p-2 bg-gray-100 hover:bg-gray-200 rounded text-left text-xs",children:[e.jsx("span",{className:"ml-1",children:M(c)}),e.jsx("span",{className:"truncate",children:c.split("/").pop()})]},E))})]}),t.videos.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-1",children:"ویدیوها"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:t.videos.map((c,E)=>e.jsxs("button",{onClick:()=>p(c),className:"flex items-center p-2 bg-gray-100 hover:bg-gray-200 rounded text-left text-xs",children:[e.jsx("span",{className:"ml-1",children:M(c)}),e.jsx("span",{className:"truncate",children:c.split("/").pop()})]},E))})]}),t.audioFiles.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h6",{className:"text-sm font-medium text-gray-700 mb-1",children:"فایل‌های صوتی"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:t.audioFiles.map((c,E)=>e.jsxs("button",{onClick:()=>p(c),className:"flex items-center p-2 bg-gray-100 hover:bg-gray-200 rounded text-left text-xs",children:[e.jsx("span",{className:"ml-1",children:M(c)}),e.jsx("span",{className:"truncate",children:c.split("/").pop()})]},E))})]})]})]},t.id))}),N==="pets"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.pets.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:t.name}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"نوع:"})," ",t.petType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"نژاد:"})," ",t.breed]}),e.jsxs("p",{children:[e.jsx("strong",{children:"سن:"})," ",t.age," سال"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"جنسیت:"})," ",t.gender]}),e.jsxs("p",{children:[e.jsx("strong",{children:"وزن:"})," ",t.weight," کیلوگرم"]}),t.medicalHistory&&e.jsxs("p",{children:[e.jsx("strong",{children:"سابقه پزشکی:"})," ",t.medicalHistory]})]})]},t.id))}),N==="payments"&&e.jsx("div",{className:"space-y-4",children:i.payments.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["پرداخت #",t.id]}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:h(t.amount)})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t.status==="VERIFIED"?"bg-green-100 text-green-800":t.status==="PENDING_VERIFICATION"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.status==="VERIFIED"?"تایید شده":t.status==="PENDING_VERIFICATION"?"در انتظار تایید":"رد شده"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:C(t.createdAt)})]})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:t.description})]},t.id))})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(B,{onClick:y,variant:"outline",children:"بستن"})})]})})}):null},te=({isOpen:l,onClose:b,users:y})=>{const[i,f]=d.useState([]),[x,L]=d.useState(!1),[S,k]=d.useState(0),N=n=>{f(o=>o.includes(n)?o.filter(u=>u!==n):[...o,n])},m=()=>{i.length===y.length?f([]):f(y.map(n=>n.id))},I=async()=>{if(i.length!==0){L(!0),k(0);try{for(let n=0;n<i.length;n++){const o=i[n],u=y.find(C=>C.id===o);try{const C=await R.downloadUserRecord(o),h=new Blob([C.data],{type:"application/zip"}),M=window.URL.createObjectURL(h),p=document.createElement("a");p.href=M,p.download=`${u.fullName}_${u.mobileNumber}_records.zip`,document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(M),k((n+1)/i.length*100),n<i.length-1&&await new Promise(t=>setTimeout(t,1e3))}catch(C){console.error(`Error downloading records for user ${o}:`,C)}}}catch(n){console.error("Bulk download error:",n)}finally{L(!1),k(0),f([]),b()}}};return l?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"دانلود گروهی سوابق کاربران"}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600",disabled:x,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"در حال دانلود..."}),e.jsxs("span",{className:"text-sm text-gray-600",children:[Math.round(S),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${S}%`}})})]}),e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsx("button",{onClick:m,className:"text-blue-600 hover:text-blue-800 text-sm",disabled:x,children:i.length===y.length?"لغو انتخاب همه":"انتخاب همه"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[i.length," از ",y.length," کاربر انتخاب شده"]})]}),e.jsx("div",{className:"overflow-y-auto max-h-96 border rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"انتخاب"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نام کامل"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"شماره موبایل"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تعداد حیوانات"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تعداد مشاوره‌ها"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(n=>{var o,u;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:i.includes(n.id),onChange:()=>N(n.id),disabled:x,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.fullName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.mobileNumber}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((o=n.pets)==null?void 0:o.length)||0}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((u=n.consultations)==null?void 0:u.length)||0})]},n.id)})})]})}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3 space-x-reverse",children:[e.jsx("button",{onClick:b,disabled:x,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"انصراف"}),e.jsx("button",{onClick:I,disabled:i.length===0||x,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:x?"در حال دانلود...":`دانلود ${i.length} سابقه`})]})]})}):null},ae=({user:l,onViewDetails:b,onViewSubmissions:y,onDownload:i,formatDate:f})=>{const L=(()=>{const N=new Date(l.lastActivity||l.createdAt),I=Math.floor((new Date-N)/(1e3*60*60*24));return I<=7?{status:"active",color:"bg-green-100 text-green-800",text:"فعال"}:I<=30?{status:"recently-active",color:"bg-yellow-100 text-yellow-800",text:"اخیراً فعال"}:{status:"inactive",color:"bg-red-100 text-red-800",text:"غیرفعال"}})(),S=l.consultationsCount||0,k=l.paymentStatus||{text:"نامشخص",color:"text-gray-500"};return e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l.fullName}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L.color}`,children:L.text})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.jsx("span",{children:l.mobileNumber})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{className:k.color,children:k.text})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsxs("span",{children:[S," مشاوره"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse",children:[e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3a4 4 0 118 0v4m-4 6v6m-4-6h8m-8 0a2 2 0 00-2 2v6a2 2 0 002 2h8a2 2 0 002-2v-6a2 2 0 00-2-2"})}),e.jsxs("span",{children:["عضویت: ",f?f(l.createdAt):new Date(l.createdAt).toLocaleDateString("fa-IR")]})]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 mr-4",children:[e.jsxs("button",{onClick:()=>b(l),className:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsxs("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"جزئیات"]}),e.jsxs("button",{onClick:()=>y(l),className:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-xs font-medium rounded text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:[e.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"اطلاعات جامع"]}),e.jsxs("button",{onClick:()=>i(l),className:"inline-flex items-center px-3 py-1.5 border border-transparent shadow-sm text-xs font-medium rounded text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx("svg",{className:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"دانلود"]})]})]})})},re=({media:l,onClose:b})=>{var n,o,u,C;const[y,i]=d.useState(!1),[f,x]=d.useState(""),L=()=>O.getMediaUrl(l.id),S=async()=>{try{i(!0);const M=await(await O.downloadMedia(l.id)).blob(),p=window.URL.createObjectURL(M),t=document.createElement("a");t.href=p,t.download=l.originalName,document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(p)}catch{x("خطا در دانلود فایل")}finally{i(!1)}},k=h=>{if(h===0)return"0 Bytes";const M=1024,p=["Bytes","KB","MB","GB"],t=Math.floor(Math.log(h)/Math.log(M));return parseFloat((h/Math.pow(M,t)).toFixed(2))+" "+p[t]},N=h=>new Date(h).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),m=h=>{switch(h){case"medical_document":return"سند پزشکی";case"audio_file":return"فایل صوتی";case"video_file":return"فایل ویدیویی";case"voice_recording":return"ضبط صدا";default:return h}},I=()=>{const h=L();switch(l.mediaType){case"image":return e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:h,alt:l.originalName,className:"max-w-full max-h-96 object-contain rounded-lg shadow-lg",onError:()=>x("خطا در بارگذاری تصویر")})});case"video":return e.jsx("div",{className:"flex justify-center",children:e.jsxs("video",{controls:!0,className:"max-w-full max-h-96 rounded-lg shadow-lg",onError:()=>x("خطا در بارگذاری ویدیو"),children:[e.jsx("source",{src:h,type:l.mimeType}),"مرورگر شما از پخش ویدیو پشتیبانی نمی‌کند."]})});case"audio":return e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"bg-gray-100 rounded-lg p-6 text-center mb-4",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:l.originalName})]}),e.jsxs("audio",{controls:!0,className:"w-full",onError:()=>x("خطا در بارگذاری فایل صوتی"),children:[e.jsx("source",{src:h,type:l.mimeType}),"مرورگر شما از پخش صدا پشتیبانی نمی‌کند."]})]})});case"document":return e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-gray-100 rounded-lg p-8 mb-4",children:[e.jsx("svg",{className:"w-20 h-20 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-gray-600 font-medium text-lg",children:l.originalName}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:l.mimeType==="application/pdf"?"فایل PDF":"سند"})]}),l.mimeType==="application/pdf"&&e.jsx("div",{className:"mt-4",children:e.jsx("iframe",{src:h,className:"w-full h-96 border rounded-lg",title:l.originalName})})]});default:return e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-8",children:[e.jsx("svg",{className:"w-20 h-20 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("p",{className:"text-gray-600 font-medium text-lg",children:l.originalName}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"پیش‌نمایش در دسترس نیست"})]})})}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"مشاهده فایل رسانه‌ای"}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"اطلاعات فایل"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"نام فایل:"}),e.jsx("span",{className:"font-medium",children:l.originalName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"نوع:"}),e.jsx("span",{className:"font-medium",children:l.mediaType})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"دسته‌بندی:"}),e.jsx("span",{className:"font-medium",children:m(l.category)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"اندازه:"}),e.jsx("span",{className:"font-medium",children:k(l.fileSize)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"تاریخ آپلود:"}),e.jsx("span",{className:"font-medium",children:N(l.uploadedAt)})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"اطلاعات کاربر"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"نام:"}),e.jsx("span",{className:"font-medium",children:(n=l.user)==null?void 0:n.fullName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"موبایل:"}),e.jsx("span",{className:"font-medium",children:(o=l.user)==null?void 0:o.mobile})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"شناسه مشاوره:"}),e.jsxs("span",{className:"font-medium",children:["#",(u=l.consultation)==null?void 0:u.id]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"نوع مشاوره:"}),e.jsx("span",{className:"font-medium",children:(C=l.consultation)==null?void 0:C.consultationType})]})]})]})]})}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:f}),e.jsx("div",{className:"mb-6",children:I()}),e.jsxs("div",{className:"flex justify-end space-x-3 space-x-reverse",children:[e.jsx(B,{onClick:b,variant:"outline",children:"بستن"}),e.jsx(B,{onClick:S,disabled:y,className:"bg-blue-600 hover:bg-blue-700",children:y?"در حال دانلود...":"دانلود فایل"})]})]})]})})},le=()=>{const[l,b]=d.useState([]),[y,i]=d.useState(!0),[f,x]=d.useState(""),[L,S]=d.useState(null),[k,N]=d.useState(!1),[m,I]=d.useState({mediaType:"all",category:"all",userId:"",page:1,limit:20}),[n,o]=d.useState({page:1,limit:20,total:0,totalPages:0}),[u,C]=d.useState({totalFiles:0,filesByType:{audio:0,video:0,document:0,image:0},totalSizeBytes:0});d.useEffect(()=>{h(),M()},[m]);const h=async()=>{try{i(!0);const a=localStorage.getItem("token"),g={page:m.page.toString(),limit:m.limit.toString()};m.mediaType!=="all"&&(g.mediaType=m.mediaType),m.category!=="all"&&(g.category=m.category),m.userId&&(g.userId=m.userId);const v=await O.getMediaFiles(g);b(v.data||[]),o(v.pagination||{}),x("")}catch(a){_.error("Failed to load media files",{error:a}),x("خطا در بارگذاری فایل‌های رسانه‌ای")}finally{i(!1)}},M=async()=>{try{const a=await O.getMediaStats();C(a.stats||u)}catch(a){_.error("Failed to load media stats",{error:a})}},p=(a,g)=>{I(v=>({...v,[a]:g,page:1}))},t=a=>{I(g=>({...g,page:a}))},c=a=>{S(a),N(!0)},E=async a=>{if(confirm("آیا از حذف این فایل اطمینان دارید؟"))try{const g=localStorage.getItem("token");if(!(await fetch(`${API_BASE_URL}/media/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"}})).ok)throw new Error("Failed to delete media file");h(),M()}catch(g){_.error("Failed to delete media file",{error:g}),x("خطا در حذف فایل")}},A=a=>{if(a===0)return"0 Bytes";const g=1024,v=["Bytes","KB","MB","GB"],z=Math.floor(Math.log(a)/Math.log(g));return parseFloat((a/Math.pow(g,z)).toFixed(2))+" "+v[z]},D=a=>new Date(a).toLocaleDateString("fa-IR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),W=a=>{switch(a){case"audio":return e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})});case"video":return e.jsx("svg",{className:"w-5 h-5 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})});case"image":return e.jsx("svg",{className:"w-5 h-5 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})});case"document":return e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});default:return e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}},T=a=>{switch(a){case"medical_document":return"سند پزشکی";case"audio_file":return"فایل صوتی";case"video_file":return"فایل ویدیویی";case"voice_recording":return"ضبط صدا";default:return a}};return y?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(ee,{})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"کل فایل‌ها"}),e.jsx("p",{className:"text-2xl font-bold",children:u.totalFiles})]}),e.jsx("svg",{className:"w-8 h-8 text-blue-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"فایل‌های صوتی"}),e.jsx("p",{className:"text-2xl font-bold",children:u.filesByType.audio})]}),e.jsx("svg",{className:"w-8 h-8 text-green-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"ویدیوها"}),e.jsx("p",{className:"text-2xl font-bold",children:u.filesByType.video})]}),e.jsx("svg",{className:"w-8 h-8 text-purple-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-red-100 text-sm",children:"اسناد"}),e.jsx("p",{className:"text-2xl font-bold",children:u.filesByType.document})]}),e.jsx("svg",{className:"w-8 h-8 text-red-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})]})}),e.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-100 text-sm",children:"حجم کل"}),e.jsx("p",{className:"text-lg font-bold",children:A(u.totalSizeBytes)})]}),e.jsx("svg",{className:"w-8 h-8 text-yellow-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع رسانه"}),e.jsxs("select",{value:m.mediaType,onChange:a=>p("mediaType",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"همه انواع"}),e.jsx("option",{value:"audio",children:"صوتی"}),e.jsx("option",{value:"video",children:"ویدیویی"}),e.jsx("option",{value:"image",children:"تصویری"}),e.jsx("option",{value:"document",children:"سند"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"دسته‌بندی"}),e.jsxs("select",{value:m.category,onChange:a=>p("category",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"همه دسته‌ها"}),e.jsx("option",{value:"medical_document",children:"اسناد پزشکی"}),e.jsx("option",{value:"audio_file",children:"فایل‌های صوتی"}),e.jsx("option",{value:"video_file",children:"فایل‌های ویدیویی"}),e.jsx("option",{value:"voice_recording",children:"ضبط صدا"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"شناسه کاربر"}),e.jsx("input",{type:"text",value:m.userId,onChange:a=>p("userId",a.target.value),placeholder:"شناسه کاربر...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تعداد در صفحه"}),e.jsxs("select",{value:m.limit,onChange:a=>p("limit",parseInt(a.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]})}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:f}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"فایل"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"کاربر"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"مشاوره"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نوع"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"اندازه"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاریخ آپلود"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"عملیات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(a=>{var g,v,z,F;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[W(a.mediaType),e.jsxs("div",{className:"mr-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.originalName}),e.jsx("div",{className:"text-sm text-gray-500",children:T(a.category)})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:(g=a.user)==null?void 0:g.fullName}),e.jsx("div",{className:"text-sm text-gray-500",children:(v=a.user)==null?void 0:v.mobile})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:["#",(z=a.consultation)==null?void 0:z.id]}),e.jsx("div",{className:"text-sm text-gray-500",children:(F=a.consultation)==null?void 0:F.consultationType})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a.mediaType==="audio"?"bg-green-100 text-green-800":a.mediaType==="video"?"bg-blue-100 text-blue-800":a.mediaType==="image"?"bg-purple-100 text-purple-800":"bg-red-100 text-red-800"}`,children:a.mediaType})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:A(a.fileSize)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:D(a.uploadedAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2 space-x-reverse",children:[e.jsx("button",{onClick:()=>c(a),className:"text-blue-600 hover:text-blue-900",children:"مشاهده"}),e.jsx("button",{onClick:()=>E(a.id),className:"text-red-600 hover:text-red-900",children:"حذف"})]})})]},a.id)})})]})}),n.totalPages>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx(B,{onClick:()=>t(n.page-1),disabled:n.page<=1,variant:"outline",size:"sm",children:"قبلی"}),e.jsx(B,{onClick:()=>t(n.page+1),disabled:n.page>=n.totalPages,variant:"outline",size:"sm",children:"بعدی"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["نمایش"," ",e.jsx("span",{className:"font-medium",children:(n.page-1)*n.limit+1})," ","تا"," ",e.jsx("span",{className:"font-medium",children:Math.min(n.page*n.limit,n.total)})," ","از"," ",e.jsx("span",{className:"font-medium",children:n.total})," ","نتیجه"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>t(n.page-1),disabled:n.page<=1,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"قبلی"}),Array.from({length:Math.min(5,n.totalPages)},(a,g)=>{const v=g+1;return e.jsx("button",{onClick:()=>t(v),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${v===n.page?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:v},v)}),e.jsx("button",{onClick:()=>t(n.page+1),disabled:n.page>=n.totalPages,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50",children:"بعدی"})]})})]})]})]}),k&&L&&e.jsx(re,{media:L,onClose:()=>{N(!1),S(null)}})]})},oe=()=>{const l=X(),[b,y]=d.useState([]),[i,f]=d.useState([]),[x,L]=d.useState([]),[S,k]=d.useState([]),[N,m]=d.useState(!0),[I,n]=d.useState(""),[o,u]=d.useState(null),[C,h]=d.useState(null),[M,p]=d.useState(!1),[t,c]=d.useState("table"),[E,A]=d.useState(""),[D,W]=d.useState("all"),[T,a]=d.useState("users"),[g,v]=d.useState({totalUsers:0,totalPayments:0,totalConsultations:0,pendingPayments:0});d.useEffect(()=>{z()},[]),d.useEffect(()=>{q()},[b,E,D]);const z=async()=>{try{m(!0);const[s,r,j,w]=await Promise.all([U.getAllUsers().catch(()=>({data:[]})),U.getAllPayments().catch(()=>({data:[]})),U.getAllConsultations().catch(()=>({data:[]})),U.getDashboardStats().catch(()=>({}))]),P=s.data||s||[],$=r.data||r||[],K=j.data||j||[];y(P),L($),k(K),v(w||{totalUsers:P.length,totalPayments:$.length,totalConsultations:K.length,pendingPayments:$.filter(Q=>Q.status==="PENDING_VERIFICATION").length})}catch(s){_.error("Failed to load dashboard data",{error:s}),n("خطا در بارگذاری اطلاعات داشبورد"),J()}finally{m(!1)}},F=async s=>{try{const r=await R.downloadUserRecord(s.id),j=new Blob([r.data],{type:"application/zip"}),w=window.URL.createObjectURL(j),P=document.createElement("a");P.href=w,P.download=`${s.fullName}_${s.mobileNumber}_records.zip`,document.body.appendChild(P),P.click(),document.body.removeChild(P),window.URL.revokeObjectURL(w)}catch(r){n("خطا در دانلود فایل: "+r.message)}},J=()=>{const s=[{id:1,fullName:"احمد محمدی",mobile:"09123456789",createdAt:new Date().toISOString(),pets:[{name:"میو",petType:"گربه",breed:"پرشین",age:3,gender:"نر"}]},{id:2,fullName:"فاطمه احمدی",mobile:"09987654321",createdAt:new Date().toISOString(),pets:[{name:"رکس",petType:"سگ",breed:"ژرمن",age:5,gender:"نر"}]}],r=[{id:1,userId:1,amount:28e4,status:"VERIFIED",createdAt:new Date().toISOString()},{id:2,userId:2,amount:28e4,status:"PENDING_VERIFICATION",createdAt:new Date().toISOString()}],j=[{id:1,userId:1,consultationType:"مشاوره عمومی",status:"COMPLETED",description:"مشاوره در مورد تغذیه گربه",createdAt:new Date().toISOString()}];y(s),L(r),k(j),v({totalUsers:s.length,totalPayments:r.length,totalConsultations:j.length,pendingPayments:r.filter(w=>w.status==="PENDING_VERIFICATION").length})},q=()=>{let s=b;E&&(s=s.filter(r=>r.fullName.toLowerCase().includes(E.toLowerCase())||r.mobile.includes(E))),D!=="all"&&(D==="paid"?s=s.filter(r=>x.filter(w=>w.userId===r.id).some(w=>w.status==="VERIFIED")):D==="pending"?s=s.filter(r=>x.filter(w=>w.userId===r.id).some(w=>w.status==="PENDING_VERIFICATION")):D==="no-payment"&&(s=s.filter(r=>x.filter(w=>w.userId===r.id).length===0))),f(s)},H=s=>{const r=x.filter(P=>P.userId===s);if(r.length===0)return{status:"no-payment",text:"بدون پرداخت",color:"text-gray-500"};const j=r.some(P=>P.status==="VERIFIED"),w=r.some(P=>P.status==="PENDING_VERIFICATION");return j?{status:"verified",text:"تایید شده",color:"text-green-600"}:w?{status:"pending",text:"در انتظار تایید",color:"text-yellow-600"}:{status:"rejected",text:"رد شده",color:"text-red-600"}},G=s=>S.filter(r=>r.userId===s),V=s=>new Date(s).toLocaleDateString("fa-IR"),Y=s=>new Intl.NumberFormat("fa-IR").format(s)+" تومان";return N?e.jsx("div",{className:"min-h-screen gradient-bg flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-white mx-auto mb-4"}),e.jsx("p",{className:"text-white text-lg",children:"در حال بارگذاری..."})]})}):e.jsxs("div",{className:"min-h-screen gradient-bg",children:[e.jsx("div",{className:"bg-white shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"داشبورد مدیریت"}),e.jsx(B,{onClick:()=>l("/dashboard"),variant:"outline",size:"sm",children:"بازگشت به داشبورد"})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"کل کاربران"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.totalUsers})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"کل پرداخت‌ها"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.totalPayments})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"کل مشاوره‌ها"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.totalConsultations})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"پرداخت‌های در انتظار"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.pendingPayments})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8 px-6",children:[e.jsx("button",{onClick:()=>a("users"),className:`py-4 px-1 border-b-2 font-medium text-sm ${T==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"مدیریت کاربران"}),e.jsx("button",{onClick:()=>a("payments"),className:`py-4 px-1 border-b-2 font-medium text-sm ${T==="payments"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"مدیریت پرداخت‌ها"}),e.jsx("button",{onClick:()=>a("consultations"),className:`py-4 px-1 border-b-2 font-medium text-sm ${T==="consultations"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"مدیریت مشاوره‌ها"}),e.jsx("button",{onClick:()=>a("media"),className:`py-4 px-1 border-b-2 font-medium text-sm ${T==="media"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"مدیریت رسانه‌ها"})]})}),T==="users"&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Z,{type:"text",placeholder:"جستجو بر اساس نام یا شماره موبایل...",value:E,onChange:s=>A(s.target.value)})}),e.jsx("div",{className:"md:w-48",children:e.jsxs("select",{value:D,onChange:s=>W(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"همه کاربران"}),e.jsx("option",{value:"paid",children:"پرداخت شده"}),e.jsx("option",{value:"pending",children:"در انتظار تایید"}),e.jsx("option",{value:"no-payment",children:"بدون پرداخت"})]})}),e.jsxs("div",{className:"flex items-center space-x-3 space-x-reverse",children:[e.jsxs("div",{className:"flex rounded-md shadow-sm",children:[e.jsx("button",{onClick:()=>c("table"),className:`px-3 py-2 text-sm font-medium rounded-r-md border ${t==="table"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M3 6h18m-9 8h9"})})}),e.jsx("button",{onClick:()=>c("cards"),className:`px-3 py-2 text-sm font-medium rounded-l-md border-t border-b border-l ${t==="cards"?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})})]}),e.jsxs("button",{onClick:()=>p(!0),className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center space-x-2 space-x-reverse",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{children:"دانلود گروهی"})]})]})]}),t==="table"?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"کاربر"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"شماره موبایل"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"وضعیت پرداخت"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تعداد مشاوره‌ها"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاریخ عضویت"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"عملیات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(s=>{const r=H(s.id),j=G(s.id);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:s.fullName.charAt(0)})})}),e.jsxs("div",{className:"mr-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.fullName}),e.jsxs("div",{className:"text-sm text-gray-500",children:["کاربر #",s.id]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.mobile}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`text-sm font-medium ${r.color}`,children:r.text})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j.length}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:V(s.createdAt)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsx("button",{onClick:()=>u(s),className:"text-blue-600 hover:text-blue-900 ml-4",children:"مشاهده جزئیات"}),e.jsx("button",{onClick:()=>h(s),className:"text-green-600 hover:text-green-900 ml-4",children:"اطلاعات جامع حیوان"})]})]},s.id)})})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(s=>{const r=H(s.id),j=G(s.id);return e.jsx(ae,{user:{...s,paymentStatus:r,consultationsCount:j.length},onViewDetails:u,onViewSubmissions:h,onDownload:F,formatDate:V},s.id)})})]}),T==="payments"&&e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"شناسه پرداخت"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"کاربر"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"مبلغ"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"وضعیت"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاریخ پرداخت"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"عملیات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(s=>{const r=b.find(j=>j.id===s.userId);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["#",s.id]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(r==null?void 0:r.fullName)||"نامشخص"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Y(s.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="VERIFIED"?"bg-green-100 text-green-800":s.status==="PENDING_VERIFICATION"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.status==="VERIFIED"?"تایید شده":s.status==="PENDING_VERIFICATION"?"در انتظار تایید":"رد شده"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:V(s.paymentDate||s.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-900 ml-4",children:"مشاهده رسید"})})]},s.id)})})]})})}),T==="consultations"&&e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"شناسه مشاوره"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"کاربر"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"نوع مشاوره"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"وضعیت"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاریخ ایجاد"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"عملیات"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(s=>{const r=b.find(j=>j.id===s.userId);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["#",s.id]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(r==null?void 0:r.fullName)||"نامشخص"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.consultationType}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.status==="COMPLETED"?"bg-green-100 text-green-800":s.status==="IN_PROGRESS"?"bg-blue-100 text-blue-800":s.status==="PENDING_PAYMENT"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status==="COMPLETED"?"تکمیل شده":s.status==="IN_PROGRESS"?"در حال انجام":s.status==="PENDING_PAYMENT"?"در انتظار پرداخت":s.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:V(s.createdAt)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-900 ml-4",children:"مشاهده جزئیات"})})]},s.id)})})]})})}),T==="media"&&e.jsx(le,{})]})]}),o&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"جزئیات کاربر"}),e.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"نام کامل"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:o.fullName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"شماره موبایل"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:o.mobile})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"تاریخ عضویت"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:V(o.createdAt)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"حیوانات خانگی"}),o.pets&&o.pets.length>0?e.jsx("div",{className:"space-y-2",children:o.pets.map((s,r)=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"نام:"})," ",s.name]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"نوع:"})," ",s.petType]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"نژاد:"})," ",s.breed]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"سن:"})," ",s.age," سال"]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"جنسیت:"})," ",s.gender]})]},r))}):e.jsx("p",{className:"text-sm text-gray-500",children:"هیچ حیوان خانگی ثبت نشده"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"پرداخت‌ها"}),(()=>{const s=x.filter(r=>r.userId===o.id);return s.length>0?e.jsx("div",{className:"space-y-2",children:s.map(r=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"مبلغ:"})," ",Y(r.amount)]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"وضعیت:"})," ",r.status]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"تاریخ:"})," ",V(r.paymentDate||r.createdAt)]})]},r.id))}):e.jsx("p",{className:"text-sm text-gray-500",children:"هیچ پرداختی ثبت نشده"})})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مشاوره‌ها"}),(()=>{const s=S.filter(r=>r.userId===o.id);return s.length>0?e.jsx("div",{className:"space-y-2",children:s.map(r=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"نوع:"})," ",r.consultationType]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"وضعیت:"})," ",r.status]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"توضیحات:"})," ",r.description]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"تاریخ:"})," ",V(r.createdAt)]})]},r.id))}):e.jsx("p",{className:"text-sm text-gray-500",children:"هیچ مشاوره‌ای ثبت نشده"})})()]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(B,{onClick:()=>u(null),variant:"outline",children:"بستن"})})]})})}),e.jsx(se,{user:C,isOpen:!!C,onClose:()=>h(null)}),e.jsx(te,{isOpen:M,onClose:()=>p(!1),users:i}),I&&e.jsx("div",{className:"fixed bottom-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded z-50",children:I})]})};export{oe as default};
